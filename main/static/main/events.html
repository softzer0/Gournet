<div ng-class="'objs'+r+'_'+t" dynamic-controller="t+'sCtrl'">
    <div class="angular-animate" ng-repeat="e in objs" ng-cloak><!-- ng-init="$last ? enableAnimation() : angular.noop()" class="{{ objs_animation ? 'angular-animate' : '' }}"-->
        <div ng-if="first_name !== undefined" class="mb3">{{ first_name }} <span ng-if="e.person_status != -1">gave {{ e.person_status == 1 ? 'like' : 'dislike' }} to</span><span ng-if="e.person_status == -1">posted</span>:</div>
        <div class="well bs-component clearfix pb18">
            <div ng-if="!nobusiness && (first_name !== undefined || id === undefined)">
                <legend><a class="n" ng-href="/{{ e.business.shortname }}/">{{ e.business.type_display }} "{{ e.business.name }}"</a></legend>
                <div class="pb8 pull-left"><a ng-href="/{{ e.business.shortname }}/"><img class="bor media-object" ng-src="/images/{{ e.business.id }}/avatar/64/?business=1"></a></div>
            </div>
            <div ng-switch="t">
                <div ng-switch-default>
                    <p>{{ e.text }} <small class="text-muted">&mdash; {{ e.when | timeAgo }}</small></p>
                </div>
                <div ng-switch-when="item">
                    <p><strong>{{ e.category_display }}</strong>: {{ e.name }} &mdash; {{ e.price }} {{ e.business.currency }}</p>
                </div>
            </div>
            <div class="op br">
                <span ng-switch="e.stars_avg"
                    ><span ng-switch-when="undefined"
                        ><a href="javascript:" ng-if="e.curruser_status > -1" ng-class="{'text-warning': e.curruser_status == 1}" ng-click="giveDisLike($index, false)"><i class="fa fa-plus-square"></i> {{ e.likestars_count }}</a
                        ><span ng-if="e.curruser_status == -1"><i class="fa fa-plus-square"></i> {{ e.likestars_count }}</span

                        ><a href="javascript:" ng-if="e.likestars_count-e.dislike_count != 0" ng-click="showDisLikes($index)" class="badge label-primary">{{ e.likestars_count-e.dislike_count }}</a
                        ><span ng-if="e.likestars_count-e.dislike_count == 0" class="badge">0</span

                        ><a href="javascript:" ng-if="e.curruser_status > -1" ng-class="{'text-warning': e.curruser_status == 2}" ng-click="giveDisLike($index, true)"><i class="fa fa-minus-square"></i> {{ e.dislike_count }}</a
                        ><span ng-if="e.curruser_status == -1"><i class="fa fa-minus-square"></i> {{ e.dislike_count }}</span
                    ></span
                    ><span ng-switch-default
                        ><span star-rating rating-value="e.stars_avg" user-number="e.likestars_count" user-rating="e.curruser_status" on-change="giveDisLike" on-click-stats="showDisLikes" func-params="{index: $index}"></span
                    ></span
                ></span

                ><a href="javascript:" ng-click="showComments($index)"><i class="fa fa-comment"></i> Komentari ({{ e.comment_count }})</a

                ><span ng-if="t == 'event'"><span ng-if="isFuture($index)"
                    ><a href="javascript:" class="rmn" uib-popover-template="'/static/main/modals/reminder.html'" popover-trigger="outsideClick" popover-is-open="cmb.opened[$index]" ng-click="initRmn($index)"><i class="fa fa-bell"></i> Podseti me na ovaj događaj</a
                    ><a href="javascript:" ng-click="notifySelect($index)"><i class="fa fa-users"></i> Obavesti prijatelje</a
                ></span></span

                ><span ng-if="e.curruser_status == -1"><a href="javascript:" ng-dialog-message="Are you sure that you want to delete this {{ t }}?" ng-dialog-click="delete($index)"><i class="fa fa-times"></i> Obriši</a></span>
            </div>
            <div class="cmn" ng-show="showcomm[$index][1]" ng-init="delcomm_msg = 'Are you sure that you want to delete this comment?'">
                <div class="angular-animate" ng-repeat="c in e.comments">
                    <a class="prf" ng-href="/user/{{ c.person.username }}/">
                        <div class="pb7 pull-left"><img class="bor media-object" ng-src="/images/{{ c.person.username }}/avatar/32/"></div>
                        <strong>{{ c.person.first_name }} {{ c.person.last_name }}</strong>
                    </a>
                    <span ng-if="c.manager_stars === true || c.manager_stars == -1" class="label label-info lh ml5" uib-tooltip="Manager">M</span><span ng-if="e.stars_avg !== undefined && c.manager_stars > 0" class="label label-warning lh ml5" uib-tooltip="Stars">{{ c.manager_stars }} <i class="fa fa-star"></i></span>
                    <span class="ml5" ng-if="e.curruser_status == -1 || c.is_curruser"><a href="javascript:" ng-dialog-message="{{ delcomm_msg }}" ng-dialog-click="delete($index, $parent.$parent.$index, true)"><i class="fa fa-times"></i> Obriši</a></span>
                    <p>{{ c.text }} <small class="text-muted">&mdash; {{ c.created | timeAgo }}</small></p>
                </div>
                <a href="javascript:" class="mpd lm text-center" ng-show="show_next($index)" ng-click="load_next($index)">Load more</a>
                <div class="cmn mb13 loa-c" ng-if="showcomm[$index][0] == false"><i class="fa fa-spinner fa-2x"></i></div>
                <div class="angular-animate" ng-repeat="c in e.user_comments">
                    <a class="prf" ng-href="/user/{{ c.person.username }}/">
                        <div class="pb7 pull-left"><img class="bor media-object" ng-src="/images/{{ c.person.username }}/avatar/32/"></div>
                        <strong>{{ c.person.first_name }} {{ c.person.last_name }}</strong>
                    </a>
                    <span ng-if="e.curruser_status == -1" class="label label-info lh ml5" uib-tooltip="Manager">M</span><span ng-if="e.stars_avg !== undefined && e.curruser_status > 0" class="label label-warning lh ml5" uib-tooltip="Stars">{{ c.manager_stars }} <i class="fa fa-star"></i></span>
                    <a class="ml5" href="javascript:" ng-dialog-message="{{ delcomm_msg }}" ng-dialog-click="delete($index, $parent.$index)"><i class="fa fa-times"></i> Obriši</a>
                    <p>{{ c.text }} <small class="text-muted">&mdash; {{ c.created | timeAgo }}</small></p>
                </div>
                <div class="form-group cmn mb7">
                    <textarea ng-attr-id="{{ $parent.t + $index }}" class="form-control" rows="1" placeholder="Your comment" required></textarea>
                </div>
                <input type="submit" class="btn btn-sm btn-primary" value="Submit" ng-click="submitComment($index)">
            </div>
        </div>
        <hr ng-if="toggleHr(first_name !== undefined, $last && !r)" class="mpd">
    </div>
    <a href="javascript:" class="lm mb13 text-center" ng-if="!r" ng-show="objs.has_next_page && !loading" ng-click="load_page()">Load more</a>
    <div class="loa mb13 loa-c" ng-if="!r && loading"><i class="fa fa-spinner fa-2x"></i></div>
    <div class="nev" ng-if="!objs.length && !loading"><span ng-hide="toggleHr(true, true)">No results.</span></div>
</div>